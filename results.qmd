# Results
Draft pick numbers generally give an idea of a player's potential, particularly among the top 10 picks. However, it's not a hard rule that players with higher pick numbers are superior in all aspects, like value and win shares, compared to those with lower pick numbers. There's no strong correlation between skill in drafting top players and winning championships. Notably, players from Oregon and Kentucky universities often excel in the NBA, whereas those from Maryland University typically underperform. Physically larger players, with more height and weight, tend to score higher in rebounds, while smaller players often achieve higher assist scores. NBA teams frequently opt for players around 210 cm and 120 kg or those closer to 190 cm and 80 kg. Also, non-American players usually adapt well to the NBA without significant issues.

## Data Preprocess
```{r}
#install.packages("dplyr")
#install.packages("GGally")
#install.packages("readr")
library(dplyr)
library(GGally)
library(readr)

data1 <- read.csv("all_seasons.csv")
data2 <- read.csv("nbaplayersdraft.csv")
data3 <- read.csv("player_achievements.csv")
data2 <- rename(data2, player_name = player)
d1 <- data1 %>%
  group_by(player_name, draft_number) %>%
  summarise(
    player_height = mean(player_height),
    player_weight = mean(player_weight),
    total_game = sum(gp),
    total_pointdiff = sum(net_rating * gp),
    off_rebound = sum(oreb_pct*gp)/total_game,
    def_rebound = sum(dreb_pct*gp)/total_game,
    usg_pct = sum(usg_pct*gp)/total_game,
    ts_pct= sum(ts_pct*gp)/total_game,
    ast_pct = sum(ast_pct*gp)/total_game,
    country = first(country),
    draft_round = first(draft_round),
    draft_year = first(draft_year),
    .groups = "drop"
  ) 
d1$'draft_round'[d1$'draft_round' == "Undrafted"] <- "0"
d1$'draft_round' = as.numeric(d1$'draft_round')
d1$'draft_year'[d1$'draft_year' == "Undrafted"] <- "0"
d1$'draft_year' = as.numeric(d1$'draft_year')
data2$"overall_pick" = as.character(data2$"overall_pick")
df <- inner_join(d1, data2, by = c("player_name" = "player_name", "draft_number" = "overall_pick"))
df <- left_join(df, data3, by = c ("player_name" = "Player.Name"))

df <- df %>%
  mutate(
    Total_All_Star_Selections = replace(Total_All_Star_Selections, is.na(Total_All_Star_Selections), 0),
    Total_All_NBA_Selections = replace(Total_All_NBA_Selections, is.na(Total_All_NBA_Selections), 0),
    Total_Championships = replace(Total_Championships, is.na(Total_Championships), 0)
  )
df$na_count <- rowSums(is.na(df))
df$draft_number <- as.numeric(df$draft_number)

df_1 <- df[rowSums(is.na(df)) <= 10, ]
df_processed <- df_1 %>%
  mutate_if(is.numeric, ~ifelse(is.na(.), 0, .))

```
## Overall Draft Analysis

### Points, Assists, Rebounds, Win Shares vs Pick Number (1-60)

```{r}
library(tidyr)

player_achievements <- read_csv("player_achievements.csv")
nbaplayersdraft <- read_csv("nbaplayersdraft.csv")

# Calculate the average for each metric by overall_pick
average_stats_by_pick <- nbaplayersdraft %>%
  filter(overall_pick <= 54) %>%
  group_by(overall_pick) %>%
  summarise(
    average_points_per_game = mean(points_per_game, na.rm = TRUE),
    average_total_rebounds = mean(average_total_rebounds, na.rm = TRUE),
    average_assists = mean(average_assists, na.rm = TRUE),
  )

# Convert to long format for faceting
long_stats_by_pick <- average_stats_by_pick %>%
  pivot_longer(
    cols = starts_with("average_"),
    names_to = "Metric",
    values_to = "Average"
  )

# Create the faceted plot
ggplot(long_stats_by_pick, aes(x = overall_pick, y = Average)) +
  geom_line() + 
  facet_wrap(~Metric, scales = "free_y", nrow = 4) +
  theme_minimal() +
  labs(title = "Average Player Stats by Draft Pick",
       x = "Overall Draft Pick",
       y = "Average") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  theme(legend.position = "none")


```

For each metric, they seem to level off around the 10-15th pick. So it would be to a team's benefit to get draft pick somewhere in the top 10. While there seems to be an occasional star player picked in between 15 and 40, generally a team shouldn't worry about the order as much.


### Advanced NBA Stats for Top 5 Picks Over time

```{r}

# Filter the data to include only the top 5 picks
top_picks <- nbaplayersdraft %>%
  filter(overall_pick >= 1 & overall_pick <= 5)

# Reshape the data to long format for faceting by metric
top_picks_long <- top_picks %>%
  select(year, overall_pick, win_shares, value_over_replacement) %>%
  pivot_longer(
    cols = c(win_shares, value_over_replacement),
    names_to = "Metric",
    values_to = "Value"
  )

# Create the faceted scatter plot for Win Shares and Value Over Replacement over time for the top 5 picks
ggplot(top_picks_long, aes(x = year, y = Value, color = factor(overall_pick))) +
  geom_point() +
  scale_color_brewer(palette = "PuBu", direction=-1) +  # Use a sequential color palette
  facet_wrap(~Metric, scales = "free_y") +  # Create facets for each metric
  theme_minimal() +
  labs(title = "Win Shares and Value Over Replacement for Top 5 Overall Picks Over Time",
       x = "Year",
       y = "Metric Value",
       color = "Overall Pick") +
  theme(legend.position = "right")

```

The first overall pick overall performs well in statistics of "win share" and "values over replacement", but it does not consistently end up being the best out of their draft class. For example, the first pick in 1998 scored the lowest in "win shares" and "values over replacement". In conclusion, the players with higher priority pick number may reflect the players' potential. They may also have consistent performance in NBA with their draft.

## Total Player Achievements and their Draft Team


```{r}
library(dplyr)
library(ggplot2)
library(readr)
library(tidyr)

merged_achievement_data <- left_join(player_achievements, nbaplayersdraft, by = c("Player Name" = "player"))

merged_achievement_data <- merged_achievement_data %>%
  filter(!is.na(team))

team_achievements <- merged_achievement_data %>%
  group_by(team) %>%
  summarise(
    TotalAllStarSelections = sum(Total_All_Star_Selections, na.rm = TRUE),
    TotalAllNBASelections = sum(Total_All_NBA_Selections, na.rm = TRUE),
    TotalChampionships = sum(Total_Championships, na.rm = TRUE)
  ) %>%
  arrange(desc(TotalAllStarSelections))

# Create separate Cleveland dot plots for each achievement
plot1 <- ggplot(team_achievements, aes(x = TotalAllStarSelections, y = reorder(team, TotalAllStarSelections))) +
  geom_point() +
  theme_minimal() +
  labs(title = "Total All-Star Selections per Team",
       x = "Total All-Star Selections",
       y = "Team") +
  theme(axis.text.y = element_text(hjust = 1))

plot2 <- ggplot(team_achievements, aes(x = TotalAllNBASelections, y = reorder(team, TotalAllNBASelections))) +
  geom_point() +
  theme_minimal() +
  labs(title = "Total All-NBA Selections per Team",
       x = "Total All-NBA Selections",
       y = "Team") +
  theme(axis.text.y = element_text(hjust = 1))

plot3 <- ggplot(team_achievements, aes(x = TotalChampionships, y = reorder(team, TotalChampionships))) +
  geom_point() +
  theme_minimal() +
  labs(title = "Total Championships per Team",
       x = "Total Championships",
       y = "Team") +
  theme(axis.text.y = element_text(hjust = 1))

plot1
plot2
plot3

```
There is significant variability in the number of championships won by teams. Strong team will always tend to win the championship, because of its management, and competency. Wining championship will also earn money and fans for the team, which will assist the team wining championships.Teams like "GSW" and "CHI" have a high number of championships, which suggests a history of strong performance in NBA. Teams, such as "BRK",and "CHO" have not won any championships.


### Players performance and their drafted team
```{r}
df_team <- df_processed %>%
  select(team, usg_pct:ast_pct, field_goal_percentage:free_throw_percentage)%>%
  group_by(team)%>%
  summarise(across(where(is.numeric), mean, na.rm = TRUE))%>%
  arrange(free_throw_percentage) %>%  
  mutate(team = factor(team, levels = team)) %>%
  pivot_longer(cols=usg_pct:free_throw_percentage)


ggplot(df_team, aes(x = value, y = team, fill=name)) + 
  geom_point(stat = "identity", shape = 21, color = "black", size = 1.5) +
  labs(y = "Team", x = "Category")+
  scale_color_manual(values = c("blue", "red",  "green", "yellow", "purple", "#008080"))
```
NOH, DET, and BRK teams always choose the players with greater free throw ability. The players chosen by NOK and CHO tend to have low free throw percentage. TOR and MIL are better at choosing players with strong 3 point percentage. Players picked by WSB, LAC, and GSW tend to have low 3 point percentage. NOK teams is likely to choose players with low assist ability. There is no obvious difference among players of teams in field goal, ts and usg. In summary, teams choose the players with different strength, but players picked by NOK tend to weakness in all aspects.

## College Draft Targets

### Points, Rebounds, Assists for NBA Players from each College


```{r}

# Calculate the totals for each metric by college
total_stats_by_college <- nbaplayersdraft %>%
  group_by(college) %>%
  summarise(
    total_points_per_game = sum(points_per_game, na.rm = TRUE),
    total_total_rebounds = sum(average_total_rebounds, na.rm = TRUE),
    total_assists = sum(average_assists, na.rm = TRUE)
  ) %>%
  filter(!is.na(college) & college != "") %>%
  ungroup()

# Function to create a Cleveland dot plot for a given metric
create_cleveland_plot <- function(data, metric, title) {
  top_colleges <- data %>%
    top_n(50, !!sym(metric))

  ggplot(top_colleges, aes(x = !!sym(metric), y = reorder(college, !!sym(metric)))) +
    geom_point() +
    theme_minimal() +
    labs(title = title, x = "Total", y = "College") +
    theme(axis.text.y = element_text(hjust = 1))
}

plot1 <- create_cleveland_plot(total_stats_by_college, "total_points_per_game", "Top 50 Colleges by Total Points Per Game")
plot2 <- create_cleveland_plot(total_stats_by_college, "total_total_rebounds", "Top 50 Colleges by Total Total Rebounds")
plot3 <- create_cleveland_plot(total_stats_by_college, "total_assists", "Top 50 Colleges by Total Assists")

plot1
plot2
plot3


```

### Analyze the performance of players based on their colleges
```{r}
df_cleve <- df_processed %>%
  select(college, usg_pct:ast_pct, field_goal_percentage:free_throw_percentage)%>%
  mutate(college = ifelse(college == "", "Unknown", college))%>%
  group_by(college)%>%
  filter(n()>12)%>%
  summarise(across(where(is.numeric), mean, na.rm = TRUE))%>%
  arrange(free_throw_percentage) %>%  
  mutate(college = factor(college, levels = college)) %>%
  pivot_longer(cols=usg_pct:free_throw_percentage)


ggplot(df_cleve, aes(x = value, y = college, fill=name)) + 
  geom_point(stat = "identity", shape = 21, color = "black", size = 1.5) +
  labs(y = "College", x = "Category")+
  scale_color_manual(values = c("blue", "red",  "green", "yellow", "purple", "#008080"))
```
To analyze the influence of college in draft, we analyze the players' performance in assist, field goal, free throw, shooting efficiency, and, team plays. The college will influence the style of the player in the shooting and team plays. This analysis is to find out the styles of players from certain college. To avoid the randomness of the players, we only analyze the colleges with more than 12 players. We noticed that there is significant difference in ts, usg, and field goals. Players from Gonzaga, Villanova, and Oregan tend to have higher free throw percentage, while players from Louisville, Syracuse, and Florida, tend to lower free throw percentage. If NBA team need a player to earn points through free throw, they should pick players from Louisville, Syracuse, and Florida. The players in performance in X_3 point is around the same, except players from Louisville, Florida, Maryland, and LSU. The only two college with outstanding X_3 point are Villanova, and Oregona. If NBA team need a player to earn three points, they should pick players from Villanova, and Oregona, and avoid the four colleges mentioned above. Players from UCLA, Iowa state, and Oregan tend to have higher assist percentage, while players from stanford, Gergetown, and Maryland tend to lower assist percentage (close to 0). If NBA team need a player to earn points through corporation, they should pick players from UCLA, Iowa state, and Oregan. In conclusion, players from Oregona tend to have better performance while players from Maryland perform bad in statistics.

### Top College Targets for Draft Teams

These colleges seem to be producing the best NBA players: Kentucky, Duke, UCLA, Arizona, Kansas. Are there team targeting players from these colleges on draft night?

```{r}

# Filter the dataset for the specified colleges
filtered_data <- nbaplayersdraft %>%
  filter(college %in% c("Kentucky", "Duke", "UCLA", "Arizona", "Kansas"))

# Count the number of players drafted by each team from these colleges
team_draft_counts <- filtered_data %>%
  count(team, college) %>%
  arrange(desc(n))

# Create a bar plot
ggplot(team_draft_counts, aes(x = reorder(team, n), y = n, fill = college)) +
  geom_bar(stat = "identity") +
  theme_minimal() +
  labs(title = "NBA Team Draft Counts from Top 5 Basketball Colleges",
       x = "Team",
       y = "Number of Players Drafted") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
  theme(legend.position = "bottom")

```



## Drafting Based on Physical Attributes

### Analyze the perfomance based on players's height and weight
```{r}
df_para <- df_processed[, c(3, 4, 6:11, 22:34)]
df_related <- df_para[, c(1,2, 4,5, 8,12, 16, 17)]


ggpairs(df_related,
        lower = list(continuous = wrap("points", alpha = 0.1, size = 0.2)))


cor_matrix <- cor(df_para)
print(cor_matrix )
```
To analyze the factor of weight and height in drafting. We first analyzed the correlation matrix of the height and weight to the other performance statistics. It is reasonable that height and weight are highly correlated and statistics about rebound, assist, and X_3 points have high absolute value of correlation score with height and weight. Then, we analyze the pair plot of these variables. The distribution of performance variables are all positive skewed, while the distribution of height and weight are close to the normal distribution. The scatter plot of height and weight with performance statistics are almost the same. We have the same conclusion for them. The different thing is height plot tend to have grid shape, which may caused by players tend to round up their height to integer. Statistics about rebound are positive related to the height weight, Players with high weight and height tend to have larger variance in the rebound statistics, whereas player with low weight and height has lower variance. We can draw the following conclusion that if the team need to strength their rebound aspects, they should absolutely draw players with high height and weight, but these players may not get enough rebound in the match.The similar things happen to the assist statistics. Assist statistics are negatively correlated to the height and weight. Players with high weight and height tend to have lower variance in the assist statistics, whereas player with low weight and height has higher variance. If a team need to strength their team corporation(assist), they should absolutely draw players with low height and weight, but these players may not assist enough in the match. We also discover that the variance difference is more obvious in the average assist, but less in assist percentage(Percentage of teammate field goals the player assisted). 

### Analyze the weight and height of players over time
```{r}
#install.packages("ggforce")
library(ggforce)
df_overtime <- df_processed%>%
  filter(draft_round ==1)


p<-ggplot(df_overtime, aes(x = player_height, y = player_weight)) +
  geom_hex(bins = 10)
  #geom_point(alpha=0.3, size=1) +
  labs(x = "Height", y = "Weight", title = "Scatter plot by Draft Year")

for (n in c(1,2, 3)){
  p <- p + facet_wrap_paginate(~draft_year, ncol = 4, nrow = 4, page = n)
  print(p)
}
```
To analyze the draft preference of NBA team, facet the heatmap by draft year. We filter the players in the first draft round, to reflect the NBA preference. The general shape is linear relationship with height(180-220) and weight(80-130). However, there is difference in draft preference. In 1991, 1995, 2006, and 2012, NBA teams prefers players with larger height and weight. In 1994, 2006, 2011,2019，and, 2021, NBA teams prefer players with smaller height and weight. In 2012, 2017,and 2018, NBA teams prefer players with large height or small height. The preference doe not last long for years and we cannot derive any conclusion from this. However, players whose height is around 210 or 190, with corresponding weight of 120 or 80, are overall preferred to be selected.

### Analyze the perfomance difference bwtween American and non-American players
```{r}
df_origin <- df_processed %>%
  mutate(country = ifelse(country == "USA", "USA","non-American"))%>%
  group_by(country)%>%
  summarise(across(where(is.numeric), mean, na.rm = TRUE))%>%
  select(country,usg_pct:ast_pct, field_goal_percentage:free_throw_percentage)%>%
  lapply(function(x) if(is.numeric(x)) x / x[1] else x) %>%
  as.data.frame()%>%
  pivot_longer(cols = usg_pct:free_throw_percentage, names_to = "statistics" )


ggplot(df_origin, aes(statistics, value, fill = country))+
  geom_bar(stat="identity", position = position_dodge())+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```
The overall performance of non-American players is slightly worse than that of American player. The obvious difference between american player and non-american player is assist percentage. The assist percentage of non-american player is 20% lower than that of american player. Non-american did not show any adapting problem in playing in NBA. Drafting american players will not be a better choice. 



